
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://slackline.codeberg.page/pcc-admin/calendar/" rel="canonical"/>
<link href="../meetings/" rel="prev"/>
<link href="../signal/" rel="next"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.22" name="generator"/>
<title>Events Calendar - PCC Admin</title>
<link href="../assets/stylesheets/main.84d31ad4.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#events-calendar">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="PCC Admin" class="md-header__button md-logo" data-md-component="logo" href=".." title="PCC Admin">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            PCC Admin
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Events Calendar
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="custom" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="custom" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="custom" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="custom" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://codeberg.org/slackline/pcc-admin/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    Codeberg
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="PCC Admin" class="md-nav__button md-logo" data-md-component="logo" href=".." title="PCC Admin">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    PCC Admin
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://codeberg.org/slackline/pcc-admin/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
</div>
<div class="md-source__repository">
    Codeberg
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../meetings/">
<span class="md-ellipsis">
    Meetings
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Events Calendar
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Events Calendar
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ownership">
<span class="md-ellipsis">
      Ownership
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#google-sheets">
<span class="md-ellipsis">
      Google Sheets
    </span>
</a>
<nav aria-label="Google Sheets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#schedule">
<span class="md-ellipsis">
      Schedule
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trips">
<span class="md-ellipsis">
      Trips
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#google-calendar">
<span class="md-ellipsis">
      Google Calendar
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#google-scripts">
<span class="md-ellipsis">
      Google Scripts
    </span>
</a>
<nav aria-label="Google Scripts" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#updating-calendar">
<span class="md-ellipsis">
      Updating Calendar
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations">
<span class="md-ellipsis">
      Limitations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-the-calendar">
<span class="md-ellipsis">
      Using the Calendar
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../signal/">
<span class="md-ellipsis">
    Signal
    
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ownership">
<span class="md-ellipsis">
      Ownership
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#google-sheets">
<span class="md-ellipsis">
      Google Sheets
    </span>
</a>
<nav aria-label="Google Sheets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#schedule">
<span class="md-ellipsis">
      Schedule
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trips">
<span class="md-ellipsis">
      Trips
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#google-calendar">
<span class="md-ellipsis">
      Google Calendar
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#google-scripts">
<span class="md-ellipsis">
      Google Scripts
    </span>
</a>
<nav aria-label="Google Scripts" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#updating-calendar">
<span class="md-ellipsis">
      Updating Calendar
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations">
<span class="md-ellipsis">
      Limitations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-the-calendar">
<span class="md-ellipsis">
      Using the Calendar
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="events-calendar">Events Calendar</h1>
<p>The Meets Secretary organises a schedule of evening and weekend meets and helps coordinate trips away.</p>
<p>For the convenience of members these are added to a Google Calendar and shared so that people have a simple way of
looking up on their mobile devices where they are going.</p>
<p>This page details how to administer and add new events to the calendar. An overview of the steps required is shown in
the flowchart below.</p>
<div class="mermaid">flowchart TD
    A(Decide Schedule) --&gt; |Evening/Weekend events| B(Add to Schedule Google Calendar)
    A --&gt;|Trips or Training| C(Add to Trips/Training)
    B --&gt; D(Run PCC script)
    C --&gt; D
    D --&gt; E(Share details with Club Secretary)
    E --&gt; F(Club Secretary Notifies members of updates and availability)
</div>
<h2 id="ownership">Ownership</h2>
<p>For this to work someone needs a Google account under which to store the data, calendars and run scripts. For the time
being these reside with Neil Shephard who has a disposable Gmail account to do things associated with climbing. In time
it may make sense to transfer ownership and responsibility of these tasks to the club Secretary and the associated account.</p>
<h2 id="google-sheets">Google Sheets</h2>
<p>In order to work the schedule needs to be saved as a <a href="https://support.google.com/a/users/answer/9282959?hl=en">Google Sheets</a> with columns in a specific
order. The current spreadsheet to which events can be added to <a href="https://docs.google.com/spreadsheets/d/14bFheHdIk8RrWQsDYKMBgmciu9zmjT80zzLd8skBSug/">Peak Climbing Club Schedule</a>. There are
two worksheets <code>schedule</code> and <code>trips</code>. The former is for evening and weekend days out, the later for weekend meets away
and longer trips.</p>
<h3 id="schedule">Schedule</h3>
<p>The columns (aka "Schema") of this sheet is as follows</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>CalendarID</code></td>
<td>str</td>
<td>Calendar to which the event should be added.</td>
</tr>
<tr>
<td style="text-align: left;"><code>Date</code></td>
<td>date</td>
<td>Date in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO8601</a> <code>YYYY-MM-DD</code> format.</td>
</tr>
<tr>
<td style="text-align: left;"><code>Start Time</code></td>
<td>time</td>
<td>Time in <code>HH:MM</code> format.</td>
</tr>
<tr>
<td style="text-align: left;"><code>End Time</code></td>
<td>time</td>
<td>Time in <code>HH:MM</code> format.</td>
</tr>
<tr>
<td style="text-align: left;"><code>Primary Venue</code></td>
<td>str</td>
<td>Venue for the event, typically a crag or indoor wall.</td>
</tr>
<tr>
<td style="text-align: left;"><code>Backup</code></td>
<td>str</td>
<td>Backup venue.</td>
</tr>
<tr>
<td style="text-align: left;"><code>Pub</code></td>
<td>str</td>
<td>Pub for post-climbing refreshments</td>
</tr>
<tr>
<td style="text-align: left;"><code>Notes</code></td>
<td>str</td>
<td>Notes, typically around parking at the proposed venue.</td>
</tr>
<tr>
<td style="text-align: left;"><code>EventStart</code></td>
<td>formula</td>
<td><code>Date</code> + <code>Start Time</code> combined to a single field (used in calendar)</td>
</tr>
<tr>
<td style="text-align: left;"><code>EventEnd</code></td>
<td>formula</td>
<td><code>Date</code> + <code>End Time</code> combined to a single field (used in calendar)</td>
</tr>
<tr>
<td style="text-align: left;"><code>EventName</code></td>
<td>formula</td>
<td><code>Primary Venue</code> + <code>Backup</code> combined to a single field (used in calendar)</td>
</tr>
<tr>
<td style="text-align: left;"><code>EventDetails</code></td>
<td>formula</td>
<td><code>Pub</code> + <code>Notes</code> combined to a single field (used in calendar)</td>
</tr>
<tr>
<td style="text-align: left;"><code>Civil Twilight</code></td>
<td>time</td>
<td>Sunset time, not currently used.</td>
</tr>
</tbody>
</table>
<h3 id="trips">Trips</h3>
<p>The columns (aka "Schema") of this sheet is as follows</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>EventStart</code></td>
<td>date</td>
<td>Date in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO8610</a> format.</td>
</tr>
<tr>
<td><code>EventEnd</code></td>
<td>date</td>
<td>Date in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO8610</a> format.</td>
</tr>
<tr>
<td><code>EventName</code></td>
<td>str</td>
<td>Short description of event, either training or venue of trip.</td>
</tr>
<tr>
<td><code>EventDetails</code></td>
<td>str</td>
<td>Typically the co-ordinator of the event.</td>
</tr>
</tbody>
</table>
<h2 id="google-calendar">Google Calendar</h2>
<p><a href="https://support.google.com/calendar/?hl=en#topic=10509740">Google Calendar</a> is used to provide a publicly available calendar which others can subscribe to if
they have Google account or other Calendar service which allows subscriptions, or a snapshot can be downloaded in
<a href="https://en.wikipedia.org/wiki/ICalendar">iCal</a> and imported to their calendar.</p>
<p>There are two calendars</p>
<ul>
<li><a href="https://calendar.google.com/calendar/embed?src=3412ff22d718172b3eccf2e345bb09be43f8c46771e10dc29f9f8d085fa2a053%40group.calendar.google.com&amp;ctz=Europe%2FLondon"><strong>PCC Local Meets</strong></a> - for Tuesday/Thursday and venues at the weekend local to Sheffield.</li>
<li><a href="https://calendar.google.com/calendar/embed?src=2f51a5bcf421937822c08f6fcbbde00ab453f958e1df1fdc277cac9256235034%40group.calendar.google.com&amp;ctz=Europe%2FLondon"><strong>PCC - Trips &amp; Training</strong></a> - for weekends away, training events and longer jaunts away climbing.</li>
</ul>
<p>A third calendar exists <strong>PCC - Test</strong> which was used when developing the workflow and code but is essentially redundant
now.</p>
<p>Club members can add these calendars to their own using the following <a href="https://en.wikipedia.org/wiki/ICalendar">iCal</a> links.</p>
<h2 id="google-scripts">Google Scripts</h2>
<p><a href="https://developers.google.com/apps-script/support">Google Scripts</a> is the glue the sticks the information on meets stored in the <a href="https://docs.google.com/spreadsheets/d/14bFheHdIk8RrWQsDYKMBgmciu9zmjT80zzLd8skBSug/">Peak Climbing Club
Schedule</a> Google Sheet into the Peak Climbing Club Calendars (both <a href="https://calendar.google.com/calendar/embed?src=3412ff22d718172b3eccf2e345bb09be43f8c46771e10dc29f9f8d085fa2a053%40group.calendar.google.com&amp;ctz=Europe%2FLondon">Local Meets</a> and
<a href="https://calendar.google.com/calendar/embed?src=2f51a5bcf421937822c08f6fcbbde00ab453f958e1df1fdc277cac9256235034%40group.calendar.google.com&amp;ctz=Europe%2FLondon">Trips</a>). It is similar in structure to <a href="https://en.wikipedia.org/wiki/JavaScript">JavaScript</a>. As with both the sheets and calendar this
has to reside under an individuals Google account but a copy of the script is version controlled as part of this
repository (see <a href="https://codeberg.org/slackline/pcc-admin/src/branch/main/scripts/populate_calendar.js">PCC Calendar Script</a>).</p>
<p>The script pulls out specific columns, based on the argument <code>event_start_col</code> provided to the <code>schedule()</code> function for
a fixed number of rows, the code is fairly lazy and expects this to be the date on which events starts which is
ultimately stored in the <code>begin</code> variable and for it to be followed columns in a specific order, the next being
<code>EventEnd</code> (stored in <code>end</code>), then <code>EventName</code> (stored in <code>venue</code>) and finally <code>EventDetails</code> (stored in <code>description</code>).</p>
<p>Existing events from <code>2025-01-01</code> through to <code>2030-01-01</code> are removed, this avoids duplicate entries occurring when the
script is re-run (a lazy option rather than checking to see if an event already exists which does have some drawbacks).</p>
<p>The list of events is then looped over, pulling out the necessary information and using the <code>CalendarApp.createEvent()</code>
method to create the event in the correct calendar with the required details.</p>
<p>It should be noted the script is <em>not</em> very well written or structured. JavaScript is not something the author is
particularly familiar with and therefore there is considerable scope for improvement.</p>
<h3 id="updating-calendar">Updating Calendar</h3>
<p>When ready to run the script use the <strong>Run</strong> button on the Google Scripts page. You can view the log messages in the
console and all being well it should sit there and churn away. It takes a while as a short pause between each submission
is required to avoid hitting the API rate limits.</p>
<h2 id="limitations">Limitations</h2>
<p>At the moment existing events are left in the spreadsheet and the value of the number of events to pull out, which is
currently <code>400</code> can be incremented if required. Ideally this limit should be very high and the code should check to see
if an event exists and <em>not</em> add it if it does, but as mentioned this is a messy hack. There are two options if the
number of rows in the Spreadsheets exceeds <code>400</code></p>
<ol>
<li>Remove old events.</li>
<li>Increase the threshold in the script.</li>
</ol>
<h2 id="using-the-calendar">Using the Calendar</h2>
<p>Members who wish to subscribe to the calendar on their own account, whether that is Google or others such as
<a href="https://proton.me/">Proton</a> (a privacy respecting email/calendar/password manager service that has a free tier available) can do so
by importing the <a href="https://en.wikipedia.org/wiki/ICalendar">iCal</a> links to their account. The links are...</p>
<ul>
<li><a href="https://calendar.google.com/calendar/ical/3412ff22d718172b3eccf2e345bb09be43f8c46771e10dc29f9f8d085fa2a053%40group.calendar.google.com/public/basic.ics">PCC Local Meets iCal</a></li>
<li><a href="https://calendar.google.com/calendar/ical/2f51a5bcf421937822c08f6fcbbde00ab453f958e1df1fdc277cac9256235034%40group.calendar.google.com/public/basic.ics">PCC Trips &amp; Training iCal</a></li>
</ul>
<p>These files can be saved (<em>Right Click &gt; Save Link</em>) and the imported to a calendar. There are instructions for
importing to <a href="https://support.google.com/calendar/answer/37118?hl=en&amp;co=GENIE.Platform%3DDesktop">Google calendars</a> and <a href="https://proton.me/support/how-to-import-calendar-to-proton-calendar">Proton calendars</a>. On mobile
downloading the above links should allow you to import them to your calendar.</p>
<p>After importing you may want to disable notifications for the imported calendar.</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>